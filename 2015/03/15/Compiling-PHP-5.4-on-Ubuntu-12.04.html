<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Compiling PHP 5.4 on Ubuntu 12.04 - AQRUN的独立博客</title>
    <meta name="author"  content="AQRUN">
    <meta name="description" content="Compiling PHP 5.4 on Ubuntu 12.04">
    <meta name="keywords"  content="php, compile, ubuntu">
    <!-- Open Graph -->
    <meta property="og:title" content="Compiling PHP 5.4 on Ubuntu 12.04 - AQRUN的独立博客">
    <meta property="og:type" content="website">
    <meta property="og:url" content="http://0.0.0.0:4000/2015/03/15/Compiling-PHP-5.4-on-Ubuntu-12.04.html">
    <meta property="og:description" content="热爱技术。很高兴能在这里与你分享我对技术和生活的思考。">
    <meta property="og:site_name" content="AQRUN的独立博客">
    <link rel="stylesheet" href="//cdn.staticfile.org/normalize/6.0.0/normalize.min.css">
    <link rel="stylesheet" href="//at.alicdn.com/t/font_roc50gemkxpw4s4i.css">
    <link rel="stylesheet" href="/assets/css/github-markdown.css">
    <link rel="stylesheet" href="/assets/prism/prism.css">
    <link rel="stylesheet" href="/assets/css/share.min.css">
    <link rel="stylesheet" href="/assets/css/app.min.css?v=0.4">
    <link rel="stylesheet" href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://cdn.staticfile.org/jquery/3.2.1/jquery.min.js"></script>
	
	<!--
Author: Ray-Eldath
refer to:
 - http://docs.mathjax.org/en/latest/options/index.html
-->

	<script type="text/javascript" async src="https://cdn.bootcss.com/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script>
	
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
		jax: ["input/TeX", "output/HTML-CSS"],
		tex2jax: {
			inlineMath: [ ["$", "$"] ],
			displayMath: [ ["$$", "$$"] ],
			skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
		},
		"HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"] }
      });
    </script>

	
    <!--
Author: Ray-Eldath
-->
<style>
    .markdown-body .anchor{
        float: left;
        margin-top: -8px;
        margin-left: -20px;
        padding-right: 4px;
        line-height: 1;
        opacity: 0;
    }
    
    .markdown-body .anchor .anchor-icon{
        font-size: 15px
    }
</style>
<script>
    $(document).ready(function() {
        let nodes = document.querySelector(".markdown-body").querySelectorAll("h1,h2,h3")
        for(let node of nodes) {
            var anchor = document.createElement("a")
            var anchorIcon = document.createElement("i")
            anchorIcon.setAttribute("class", "fa fa-anchor fa-lg anchor-icon")
            anchorIcon.setAttribute("aria-hidden", true)
            anchor.setAttribute("class", "anchor")
            anchor.setAttribute("href", "#" + node.getAttribute("id"))
            
            anchor.onmouseover = function() {
                this.style.opacity = "0.4"
            }
            
            anchor.onmouseout = function() {
                this.style.opacity = "0"
            }
            
            anchor.appendChild(anchorIcon)
            node.appendChild(anchor)
        }
    })
</script>
</head>


<body>
  <!--[if lt IE 10]>
<div class="alert-danger" role="alert">你的浏览器实在太太太旧了，放学别走，升级完浏览器再说！<a target="_blank" class="alert-link" href="http://browsehappy.com">立即升级</a></div>
<![endif]-->
  <input id="nm-switch" type="hidden" value="true"> <header class="g-header">
    <div class="g-logo">
      <a href="/"></a>
    </div>
    <i id="menu-toggle" class="iconfont icon-menu"></i>
    <nav class="g-nav">
        <ul>
            
                <li 
                
                    class="id_100"
                
                  >
                    <a href="/">首页</a>
                </li>
            
                <li 
                
                    class="id_101"
                
                  >
                    <a href="/blog/php/">PHP</a>
                </li>
            
                <li 
                
                    class="id_102"
                
                  >
                    <a href="/blog/javascript/">Javascript</a>
                </li>
            
                <li 
                
                    class="id_103"
                
                  >
                    <a href="/blog/java/">Java</a>
                </li>
            
                <li 
                
                    class="id_104"
                
                  >
                    <a href="/blog/android/">Android</a>
                </li>
            
                <li 
                
                    class="id_105"
                
                  >
                    <a href="/blog/ios/">IOS</a>
                </li>
            
                <li 
                
                    class="id_107"
                
                  >
                    <a href="/blog/ubuntu/">Ubuntu</a>
                </li>
            
                <li 
                
                    class="id_108"
                
                  >
                    <a href="/blog/drupal/">Drupal</a>
                </li>
            
                <li 
                
                    class="id_106"
                
                  >
                    <a href="/blog/diary/">随笔</a>
                </li>
            
        </ul>
    </nav>
</header>


  <header
    class="g-banner post-header post-pattern-circuitBoard bgcolor-default post-no-cover"
    data-theme="default"
  >
    <div class="post-wrapper">
      <div class="post-tags">
        
          
            <a href="http://0.0.0.0:4000/tags#php" class="post-tag">php</a>
          
            <a href="http://0.0.0.0:4000/tags#compile" class="post-tag">compile</a>
          
            <a href="http://0.0.0.0:4000/tags#ubuntu" class="post-tag">ubuntu</a>
          
        
      </div>
      <h1>Compiling PHP 5.4 on Ubuntu 12.04</h1>
      <div class="post-meta">
        <span class="post-meta-item"><i class="iconfont icon-author"></i>AQRUN</span>
        <time class="post-meta-item" datetime="15-03-15"><i class="iconfont icon-date"></i>15 Mar 2015</time>
      </div>
    </div>
    
  </header>

  <div class="post-content visible">
    

    <article class="markdown-body">
      <p>So recently I’ve been working with PHP 5.4 a LOT. Unfortunately Ubuntu (my main dev environment) is behind the times. So I’m resorting to compiling PHP manually.</p>

<p>Not a daunting as it may first appear. The really tricky part is working out your dependencies and configure script.</p>

<p>Hence the reason for this post as a reminder for myself and others that may want to do a quick compile. (I would recommend that if your compiling for a production/live environment that you make sure you understand what it is your compiling though before just using what’s here)</p>

<p>So where to start. Dependencies first I think</p>

<p>Ubuntu allows you to install dependencies for building source apt-get build-deps. We will use this and install any extras we may need.</p>

<pre class="line-numbers">
    <code class="language-shell">

    apt-get install \
    libxml2 \
    libxml2-dev \
    libssl-dev \
    pkg-config \
    curl \
    libcurl4-nss-dev \
    enchant \
    libenchant-dev \
    libjpeg8 \
    libjpeg8-dev \
    libpng12-0 \
    libpng12-dev \
    libvpx1 \
    libvpx-dev \
    libfreetype6 \
    libfreetype6-dev \
    libt1-5 \
    libt1-dev \
    libgmp10 \
    libgmp-dev \
    libicu48 \
    libicu-dev \
    mcrypt \
    libmcrypt4 \
    libmcrypt-dev \
    libpspell-dev \
    libedit2 \
    libedit-dev \
    libsnmp15 \
    libsnmp-dev \
    libxslt1.1 \
    libxslt1-dev
        
</code></pre>

<p>And now the configure</p>

<pre class="line-numbers">
    <code class="language-shell">

    ./configure \
    --prefix=/usr/local/php \
    --with-apxs2=/usr/local/apache2/bin/apxs \
    --enable-fpm \
    --with-fpm-user=www-data \
    --with-fpm-group=www-data \
    --with-config-file-path=/usr/local/php/conf \
    --with-config-file-scan-dir=/usr/local/php/conf.d \
    --enable-debug \
    --with-openssl \
    --with-kerberos \
    --with-zlib \
    --enable-calendar \
    --with-curl \
    --with-curlwrappers \
    --with-enchant \
    --enable-exif \
    --enable-ftp \
    --with-gd \
    --with-jpeg-dir=/usr \
    --with-png-dir=/usr \
    --with-vpx-dir=/usr \
    --with-freetype-dir=/usr \
    --with-t1lib \
    --enable-exif \
    --enable-gd-native-ttf \
    --enable-gd-jis-conv \
    --with-gettext \
    --with-gmp \
    --with-mhash \
    --enable-intl \
    --enable-mbstring \
    --with-mcrypt \
    --with-mysql \
    --with-mysqli \
    --enable-pcntl \
    --with-pdo-mysql \
    --with-pdo-pgsql \
    --with-pgsql \
    --with-pspell \
    --with-libedit \
    --with-readline \
    --enable-shmop \
    --with-snmp \
    --enable-soap \
    --enable-sockets \
    --enable-sysvmsg \
    --enable-sysvshm \
    --with-xsl \
    --enable-zip \
    --with-pear \
    --enable-zend-signals \
    --enable-maintainer-zts

</code>
</pre>

<p>Once these are done then we follow the standard make process. Notice we are also running make test… very important as it givges more data for the developers to work with.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Make PHP
make &amp;&amp; make test &amp;&amp; make install 1

make &amp;&amp; make test &amp;&amp; make install
</code></pre></div></div>

<p>The next thing is configuring your php.ini file as the install doesn’t have one yet so we copy either the production or development default from the source code to the new conf dir and edit to suit your needs.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Shell
cp {&lt;a href="http://www.php.net/" title="PHP" target="_blank"&gt;php&lt;/a&gt;-source-dir}/&lt;a href="http://www.php.net/" title="PHP" target="_blank"&gt;php&lt;/a&gt;.ini-(development|production) /usr/local/&lt;a href="http://www.php.net/" title="PHP" target="_blank"&gt;php&lt;/a&gt;/conf 1

cp {php-source-dir}/php.ini-(development|production) /usr/local/php/conf
</code></pre></div></div>

<p>Thats it. All ready to roll… almost, this installation is the one I use for use with a webserver so you will want to add the appropriate directives to apache.</p>

<p>Shell
    LoadModule php5_module modules/libphp5.so AddHandler php5-script .<a href="http://www.php.net/" title="PHP" target="_blank">php</a> AddType text/html .<a href="http://www.php.net/" title="PHP" target="_blank">php</a></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>LoadModule php5_module        modules/libphp5.so
 
AddHandler php5-script .php
AddType text/html .php
</code></pre></div></div>

    </article>

    
    <div class="social-share-wrapper">
      <div class="social-share"></div>
    </div>
    
  </div>

  <section class="author-detail">
    <section class="post-footer-item author-card">
      <div class="avatar">
        <img src="/assets/img/profile.png?v=0.1" alt="">
      </div>
      <div class="author-name" rel="author">AQRUN</div>
      <div class="bio">
        <p>前端开发者，热爱技术&设计，简单乐观爱创造</p>
      </div>
      
      <ul class="sns-links">
        
        <li>
          <a href="//weibo.com/aqrun" target="_blank">
                    <i class="iconfont icon-weibo"></i>
                </a>
        </li>
        
        <li>
          <a href="//www.jianshu.com/u/0b2ee2adc013" target="_blank">
                    <i class="iconfont icon-jianshu"></i>
                </a>
        </li>
        
        <li>
          <a href="//gitee.com/aqrun" target="_blank">
                    <i class="iconfont icon-gitee"></i>
                </a>
        </li>
        
        <li>
          <a href="//github.com/aqrun" target="_blank">
                    <i class="iconfont icon-github"></i>
                </a>
        </li>
        
      </ul>
      
    </section>
    <section class="post-footer-item read-next">
      
      <div class="read-next-item">
        <a href="/2015/03/31/ubuntu%E4%B8%8Bvsftpd%E9%85%8D%E7%BD%AE%E8%AF%A6%E7%BB%86%E7%AF%87.html" class="read-next-link"></a>
        <section>
          <span>ubuntu下vsftpd配置详细篇</span>
          <p> 1、 本人配置的ftp服务器的设计要求如下： （1）、匿名用户可登录浏览，但不能下载 （2）、设置4个不同等级的...</p>
        </section>
        
     </div>
      

      
      <div class="read-next-item">
        <a href="/2015/01/08/ubuntu%E4%BF%AE%E6%94%B9IP%E5%9C%B0%E5%9D%80%E5%92%8C%E7%BD%91%E5%85%B3%E7%9A%84%E6%96%B9%E6%B3%95.html" class="read-next-link"></a>
          <section>
            <span>ubuntu修改IP地址和网关的方法</span>
            <p>一、使用命令设置Ubuntu IP地址</p>
          </section>
          
      </div>
      
    </section>
    
  </section>

  <footer class="g-footer">
  <section>AQRUN的独立博客 ©
  
  
    2014
    -
  
  2018
  </section>
  <section>Powered by <a href="//jekyllrb.com">Jekyll</a> | <a href="https://github.com/kaeyleo/jekyll-theme-H2O">Theme H2O</a></section>
</footer>


  <script src="/assets/js/social-share.min.js"></script>
  <script>
    socialShare('.social-share', {
      sites: [
        
          'wechat'
          ,
          
        
          'weibo'
          ,
          
        
          'douban'
          ,
          
        
          'twitter'
          
        
      ],
      wechatQrcodeTitle: "分享到微信朋友圈",
      wechatQrcodeHelper: '<p>扫码后点击右上角</p><p>将本文分享至朋友圈</p>'
    });
  </script>

  

  <script src="/assets/prism/prism.js"></script>
  <script src="/assets/js/index.min.js?v=0.1"></script>
</body>

</html>
